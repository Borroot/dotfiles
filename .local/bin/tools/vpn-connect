#!/usr/bin/env zsh

CONFIG_FILE=$HOME/.config/vpn/laptop.ovpn
LOG=$PWD/vpn_log

if [[ -f $CONFIG_FILE ]]
then
	echo Connecting to VPN...
	sudo openvpn $CONFIG_FILE > $LOG &!

	sleep 10
	if grep -q "Initialization Sequence Completed" $LOG
	then
		echo Connected to VPN!
		rm "$LOG"
	else
		echo Something went wrong, check the log file at $LOG.
	fi
else
	echo The file $CONFIG_FILE does not exist.
fi
